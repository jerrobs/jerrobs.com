<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta content="width=device-width" name=viewport><link href=/assets/icons/favicon.svg rel=icon type=image/svg+xml><link href=https://www.jerrobs.com/issues/pathicles/pth-001/ rel=canonical><meta content="Astro v2.6.1" name=generator><title>Approximating movement</title><meta content="Approximating movement" name=title><meta content="The relativitic equations of motion of a particle system can only be solved analytically in very special cases. However, there is a class of well known numerical algorithms that are specialised in the numerical approximation.
" name=description><meta content="Dirk Rathje" name=author><script src=/toggle-theme.js defer=defer></script><link href=/manifest.webmanifest rel=manifest><link href=/assets/about-d0c889e7.css rel=stylesheet /><script src=/_astro/hoisted.88db4f2a.js type=module></script></head><body><div class=layout><div class=layout__header><header class=astro-3EF6KSR2><a class="astro-3EF6KSR2 skip-to-content" href=#main-content>Skip to content</a><div class="astro-3EF6KSR2 nav-container"><a class="astro-3EF6KSR2 logo" href=/ ><object alt="[logo] J. Err. Obs" class="astro-3EF6KSR2 jerrobs" data=/assets/jerrobs.svg height=28 type=image/svg+xml width=138></object></a><nav class=astro-3EF6KSR2 id=nav-menu><ul class="astro-3EF6KSR2 body-md" id=menu-items><li class=astro-3EF6KSR2><a class=astro-3EF6KSR2 href=/issues>Issues</a></li><li class=astro-3EF6KSR2><a class=astro-3EF6KSR2 href=/references>References</a></li><li class=astro-3EF6KSR2><a class=astro-3EF6KSR2 href=/about>About</a></li><li class=astro-3EF6KSR2><button aria-label=auto aria-live=polite class="astro-3EF6KSR2 focus-outline" id=theme-btn title="Toggles light & dark"><svg class=astro-3EF6KSR2 id=moon-svg xmlns=http://www.w3.org/2000/svg><path class=astro-3EF6KSR2 d="M21.7519 15.0019C20.597 15.4839 19.3296 15.75 18 15.75C12.6152 15.75 8.25 11.3848 8.25 5.99999C8.25 4.67039 8.51614 3.40296 8.99806 2.24805C5.47566 3.71785 3 7.19481 3 11.25C3 16.6348 7.36522 21 12.75 21C16.8052 21 20.2821 18.5243 21.7519 15.0019Z" stroke=#0F172A stroke-linecap=round stroke-linejoin=round stroke-width=1.5 xmlns=http://www.w3.org/2000/svg></path></svg> <svg class=astro-3EF6KSR2 id=sun-svg xmlns=http://www.w3.org/2000/svg><path class=astro-3EF6KSR2 d="M12 3V5.25M18.364 5.63604L16.773 7.22703M21 12H18.75M18.364 18.364L16.773 16.773M12 18.75V21M7.22703 16.773L5.63604 18.364M5.25 12H3M7.22703 7.22703L5.63604 5.63604M15.75 12C15.75 14.0711 14.0711 15.75 12 15.75C9.92893 15.75 8.25 14.0711 8.25 12C8.25 9.92893 9.92893 8.25 12 8.25C14.0711 8.25 15.75 9.92893 15.75 12Z" stroke=#0F172A stroke-linecap=round stroke-linejoin=round stroke-width=1.5 xmlns=http://www.w3.org/2000/svg></path></svg></button></li></ul></nav></div></header><nav class="astro-ILHXCYM7 breadcrumb" aria-label=breadcrumb><p class=astro-ILHXCYM7></p><ul class=astro-ILHXCYM7><li class="astro-ILHXCYM7 body-sm"><a class=astro-ILHXCYM7 href=/ >Home</a></li><li class="astro-ILHXCYM7 body-sm"><a class=astro-ILHXCYM7 href=/issues>issues</a></li><li class="astro-ILHXCYM7 body-sm"><a class=astro-ILHXCYM7 href=/issues/pathicles>pathicles</a></li><li class="astro-ILHXCYM7 body-sm"><a class=astro-ILHXCYM7 href=/issues/pathicles/pth-001>pth-001</a></li></ul></nav></div><div class=layout__main><article class=article role=article><header class=article-header><h1 class="body-xl italic uppercase article-title bold">Approximating movement</h1><p class="body-xl italic uppercase article-subtitle">by relativistic leapfrogging</p><p class="body-md article-abstract bold mb-1">The relativitic equations of motion of a particle system can only be solved analytically in very special cases. However, there is a class of well known numerical algorithms that are specialised in the numerical approximation.</p></header><div class=article-body><p class=md>Today, the movement of charged particles influenced by electric and magnetic forces is not rocket science and part of the school curriculum. That was a different story before Dutch physicist Hendrik Antoon Lorentz (1853-1928) derived the equation of motions from Maxwell equations of electromagnetism in 1895 (<bib-ref cite-key=lorentz__1895__versuch>). This feat is the reason why the electromagnetic force is called “Lorentz force”.</bib-ref></p><p class=md>::: level1 Lorentz force</p><p class=md>The electric and magnetic component of the Lorentz force have very different properties. While the electric force only depends on field strength and charge, the magnetic force is additionally dependent on the value and direction of the particle’s velocity</p><p class=md>:::</p><p class=md>The electric and magnetic component of the Lorentz force have very different properties. While the electric force only depends on field strength and charge, the magnetic force is additionally dependent on the value and direction of the particle’s velocity.</p><p class=md>::: level1 Relativistic equations of motion</p><p class=md>The relativistic motion of a particle in an electromagnetic field must satisfy the relativistic extension of Newton’s second law, which means the equality of change in momentum and Lorentz force.</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line></span>
<span class=line><span style=color:#e06c75>du</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>dt</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>)(</span><span style=color:#e5c07b>E</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>&#x26;</span><span style=color:#e06c75>timey</span><span style=color:#abb2bf>; </span><span style=color:#e5c07b>B</span><span style=color:#abb2bf>)</span></span>
<span class=line><span style=color:#abb2bf>  </span><span style=color:#7f848e;font-style:italic>// equation of motion I</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#e06c75>dx</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>dt</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v</span></span>
<span class=line><span style=color:#abb2bf>  </span><span style=color:#7f848e;font-style:italic>// equation of motion II</span></span>
<span class=line></span></code></pre><p class=md>with</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line></span>
<span class=line><span style=color:#abb2bf>u :</span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>γv</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>p</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span></span>
<span class=line><span style=color:#abb2bf>  </span><span style=color:#7f848e;font-style:italic>// spatial part of the four-velocity</span></span>
<span class=line></span>
<span class=line><span style=color:#abb2bf>β :</span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>c</span></span>
<span class=line><span style=color:#abb2bf>  </span><span style=color:#7f848e;font-style:italic>// beta, the relative velocity</span></span>
<span class=line><span style=color:#abb2bf>  </span><span style=color:#7f848e;font-style:italic>// (relative to the speed of light)</span></span>
<span class=line></span>
<span class=line><span style=color:#abb2bf>γ :</span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#d19a66>1</span><span style=color:#56b6c2>/</span><span style=color:#61afef>sqrt</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>1</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>-</span><span style=color:#abb2bf> </span><span style=color:#e06c75>β</span><span style=color:#abb2bf>²) </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#61afef>sqrt</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>1</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>u</span><span style=color:#abb2bf>²</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>c</span><span style=color:#abb2bf>²)</span></span>
<span class=line><span style=color:#abb2bf>  </span><span style=color:#7f848e;font-style:italic>// gamma, the Lorentz factor</span></span>
<span class=line></span></code></pre><p class=md>:::</p><section class=md><h2 class=md id=analytical-solutions>Analytical solutions</h2><p class=md>The relativistic equations of motion can only be solved analytically in very special cases, which means that a simple formula can be found to calculate the location and velocity of a particle at given moments in time.</p><p class=md>One such special case is a charged particle in a uniform magnetic field and in the absence of electric forces, in which the particle orbits in a perfect circle perpendicular to the magnetic field. The radius and frequency of the gyration depends on the velocity component perpendicular to the magnetic field.</p><p class=md>::: level1 Gyration in uniform magnetic field</p><p class=md>The gyration of a charged particle in a uniform magnetic field is fullly described by the gyroradius and gyrofrequency:</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line><span style=color:#e06c75>ω</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> </span><span style=color:#e5c07b>B</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>γ</span><span style=color:#abb2bf>   </span><span style=color:#7f848e;font-style:italic>// gyrofrequency</span></span>
<span class=line><span style=color:#e5c07b>T</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> 2</span><span style=color:#e06c75>π</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>ω</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> 2</span><span style=color:#e06c75>π</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> </span><span style=color:#e06c75>m</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>q</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> </span><span style=color:#e06c75>γ</span><span style=color:#56b6c2>/</span><span style=color:#e5c07b>B</span><span style=color:#abb2bf>  </span><span style=color:#7f848e;font-style:italic>// gyroperiod</span></span>
<span class=line><span style=color:#e5c07b>R</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>vp</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>ω</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf>       </span><span style=color:#7f848e;font-style:italic>// gyroradius</span></span>
<span class=line></span>
<span class=line><span style=color:#c678dd>with</span><span style=color:#abb2bf> </span><span style=color:#e06c75>vp</span></span>
<span class=line></span></code></pre><p class=md>the velocity component perpendicular to the magnetic field.</p><p class=md>For <em>Pathicles</em>, both formulas are used to contruct test cases for checking the validiy of the numerical integration.</p><p class=md>:::</p></section><section class=md><h2 class=md id=numerical-solutions>Numerical Solutions</h2><p class=md>In most cases, analytical solutions to the equations of motion do not exist and you have to apply numerical integration methods. Here, the trajectory of a particle is approximated step by step at time intervals <code>Δt</code>. Different numerical approaches differ in their computational complexity and how the error depends on <code>Δt</code>.</p><section class=md><h3 class=md id=euler-integration>Euler integration</h3><p class=md>The most straightforward numerical integration approach is the Euler method that calculates the new position and velocity by simply treating the infinitesimal <code>Δt</code> of the differential operator as the finite time interval <code>Δt</code>.</p><p class=md>::: level1 Euler integration</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line><span style=color:#e06c75>xnp1</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>xn</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>vn</span><span style=color:#abb2bf> </span><span style=color:#e06c75>Δt</span></span>
<span class=line><span style=color:#e06c75>vnp1</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>vn</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>)(</span><span style=color:#e5c07b>E</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>vn</span><span style=color:#abb2bf> × </span><span style=color:#e5c07b>B</span><span style=color:#abb2bf>) </span><span style=color:#e06c75>Δt</span></span>
<span class=line></span></code></pre><p class=md>The error of the Euler method is proportional to <code>Δt</code>.</p><p class=md>:::</p></section><section class=md><h3 class=md id=synchronized-leapfrog-integration>(Synchronized) Leapfrog Integration</h3><p class=md>To calculate the next position, the Euler method uses the velocity as it is at the beginning of each time step. A more accurate result can be expected by using the midpoint velocity instead. This can easily be achieved by shifting the time steps for the velocity approximation by half a time step. Because of this interleaving, the term leapfrog is used (<bib-ref cite-key=kreissetal__2014__introduction>).</bib-ref></p><p class=md>::: level1 Leapfrog integration</p><p class=md>A discretized version of the the differential equations of motion is</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line></span>
<span class=line><span style=color:#7f848e;font-style:italic>// leapfrog scheme</span></span>
<span class=line><span style=color:#e06c75>unp1</span><span style=color:#abb2bf>  </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>un</span><span style=color:#abb2bf>   </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>) </span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>Enp1_2</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v</span><span style=color:#abb2bf> × </span><span style=color:#e06c75>Bnp1_2</span><span style=color:#abb2bf>) </span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>Δt</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span><span style=color:#abb2bf>)</span></span>
<span class=line><span style=color:#e06c75>xnp3_2</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>xnp1_2</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>unp1</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>gnp1</span><span style=color:#abb2bf>  </span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> </span><span style=color:#e06c75>Δt</span></span>
<span class=line></span>
<span class=line></span></code></pre><p class=md>:::</p><p class=md>If you are interested in the phase-space of the motion, you need to calculate positions and velocities at the same moments in time (instead of shifted by half delta t). For this, the synchronized version of the leapfrog integration comes handy at little computational cost.</p><p class=md>::: level1 Synchronized Leapfrog integration</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line></span>
<span class=line><span style=color:#7f848e;font-style:italic>// synchronized leapfrog scheme</span></span>
<span class=line><span style=color:#e06c75>xnp1_2</span><span style=color:#abb2bf>  </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>xn</span><span style=color:#abb2bf>   </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>un</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>gn</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> </span><span style=color:#e06c75>Δt</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span></span>
<span class=line><span style=color:#e06c75>unp1</span><span style=color:#abb2bf>   </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>un</span><span style=color:#abb2bf>   </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>)[ </span><span style=color:#e06c75>Enp1_2</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v</span><span style=color:#abb2bf> × </span><span style=color:#e06c75>Bnp1_2</span><span style=color:#abb2bf>] </span><span style=color:#e06c75>Δt</span></span>
<span class=line><span style=color:#e06c75>xnp1</span><span style=color:#abb2bf>   </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>xnp1_2</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>unp1</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>gnp1</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> </span><span style=color:#e06c75>Δt</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span></span>
<span class=line></span></code></pre><p class=md>:::</p><p class=md>Leapfrog integration has two major advantages over alternative approaches such as Euler integration or Runge-Kutta methods. The first advantage is its <strong>time reversibility</strong>: You can go n steps forward and n steps backward to get to the same starting position. (The second strength is its <strong>symplectic</strong> nature, which implies that it preserves the (slightly modified) energy of dynamical systems.)</p></section><section class=md><h3 class=md id=leapfrog-integration-with-boris>Leapfrog integration with Boris</h3><p class=md>There various ways to solve the above leapfrog scheme. The first one was proposed by Boris in 1970 by setting the velocity on the right hand side to</p><p class=md>::: level1 Boris leapfrogging</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line></span>
<span class=line><span style=color:#e06c75>v</span><span style=color:#abb2bf>  </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#d19a66>1</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span><span style=color:#abb2bf> ( </span><span style=color:#e06c75>unp1</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>un</span><span style=color:#abb2bf>) </span><span style=color:#56b6c2>/</span><span style=color:#abb2bf> </span><span style=color:#e06c75>gnp1_2</span></span>
<span class=line></span>
<span class=line><span style=color:#e06c75>u</span><span style=color:#56b6c2>*</span><span style=color:#abb2bf>      </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>unp1</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>)(</span><span style=color:#e06c75>Δt</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span><span style=color:#abb2bf>) </span><span style=color:#e5c07b>E</span></span>
<span class=line><span style=color:#e06c75>u</span><span style=color:#56b6c2>**</span><span style=color:#abb2bf>     </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>u</span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>u</span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>u</span><span style=color:#56b6c2>*</span><span style=color:#abb2bf> × </span><span style=color:#e06c75>t</span><span style=color:#abb2bf>) × </span><span style=color:#e06c75>s</span></span>
<span class=line><span style=color:#e06c75>unp1</span><span style=color:#abb2bf>    </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>u</span><span style=color:#56b6c2>**</span><span style=color:#abb2bf>   </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>)(</span><span style=color:#e06c75>Δt</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span><span style=color:#abb2bf>) </span><span style=color:#e5c07b>E</span></span>
<span class=line></span></code></pre><p class=md>By applying half the electric field before the magnetic field rotation and half afterward, the algorithm becomes fully reversible and yet the magnetic interaction can be treated in the absence of an electric field. This</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line><span style=color:#e06c75>vnp3_2</span><span style=color:#abb2bf>  </span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>vnp1_2</span><span style=color:#abb2bf>  </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>)(</span><span style=color:#e06c75>Δt</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span><span style=color:#abb2bf>) </span><span style=color:#e5c07b>E</span></span>
<span class=line><span style=color:#abb2bf>                    </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>)(</span><span style=color:#e06c75>Δt</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span><span style=color:#abb2bf>)( </span><span style=color:#e06c75>v1</span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v3</span><span style=color:#abb2bf> ) × </span><span style=color:#e5c07b>B</span></span>
<span class=line><span style=color:#abb2bf>                    </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>)(</span><span style=color:#e06c75>Δt</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span><span style=color:#abb2bf>) </span><span style=color:#e5c07b>E</span></span>
<span class=line></span></code></pre><p class=md>with</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line><span style=color:#abb2bf>v1 :</span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v1</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>a</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v1</span><span style=color:#abb2bf> × </span><span style=color:#e5c07b>B</span></span>
<span class=line><span style=color:#abb2bf>v3 :</span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v2</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>b</span><span style=color:#abb2bf> </span><span style=color:#e06c75>v2</span><span style=color:#abb2bf> × </span><span style=color:#e5c07b>B</span></span>
<span class=line></span></code></pre><p class=md>and</p><pre class="astro-code one-dark-pro" is:raw="" style=background-color:#282c34;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word tabindex=0><code><span class=line><span style=color:#abb2bf>a :</span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> </span><span style=color:#61afef>tan</span><span style=color:#abb2bf>( (</span><span style=color:#e06c75>q</span><span style=color:#56b6c2>/</span><span style=color:#e06c75>m</span><span style=color:#abb2bf>) </span><span style=color:#61afef>abs</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>B</span><span style=color:#abb2bf>)</span><span style=color:#56b6c2>/</span><span style=color:#61afef>c</span><span style=color:#abb2bf> (</span><span style=color:#e06c75>Δt</span><span style=color:#56b6c2>/</span><span style=color:#d19a66>2</span><span style=color:#abb2bf>) ) </span><span style=color:#56b6c2>/</span><span style=color:#abb2bf> </span><span style=color:#61afef>abs</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>B</span><span style=color:#abb2bf>)</span></span>
<span class=line><span style=color:#abb2bf>b :</span><span style=color:#56b6c2>=</span><span style=color:#abb2bf> 2</span><span style=color:#e06c75>a</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>/</span><span style=color:#abb2bf> (</span><span style=color:#d19a66>1</span><span style=color:#abb2bf> </span><span style=color:#56b6c2>+</span><span style=color:#abb2bf> </span><span style=color:#e06c75>a</span><span style=color:#abb2bf>² </span><span style=color:#e5c07b>B</span><span style=color:#abb2bf>²)</span></span>
<span class=line></span></code></pre><p class=md>:::</p></section></section></div></article></div><div class=layout__footer><footer class="astro-SZ7XMLTE footer-wrapper"><p class="astro-SZ7XMLTE copyright-wrapper"><span class=astro-SZ7XMLTE>&#169; 2023</span> <span class="astro-SZ7XMLTE separator">&nbsp;|&nbsp;</span> <span class=astro-SZ7XMLTE>All rights reserved.</span></p></footer></div></div></body></html>